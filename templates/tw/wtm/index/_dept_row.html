{# templates/tw/wtm/index/_dept_row.html #}
{% load pybo_filter %}

<section class="rounded-2xl border border-slate-200/70 bg-white shadow-sm">
    <div class="border-b border-slate-200 px-6 py-4">
        <div class="text-sm font-semibold text-slate-800">부서별 근무자</div>
    </div>

    <div class="px-6 py-4">
        <div class="flex items-start gap-3 overflow-x-auto pb-2">
            {% for users in user_list %}
                <div class="w-[200px] shrink-0 rounded-2xl border border-slate-200 shadow-sm">
                    <div class="flex items-center justify-between gap-1 rounded-t-2xl px-3 py-2 text-white"
                        style="background: linear-gradient(135deg, #02b3bb, #00a0a7);">
                        <div class="min-w-0 truncate text-[12px] font-semibold">
                            {{ users.0.group_name }}
                        </div>
                        <div class="flex shrink-0 gap-1">
                            <span class="rounded-full bg-white/20 px-2 py-[2px] text-[10px]">오전 {{ users.0.sum_am }}</span>
                            <span class="rounded-full bg-white/20 px-2 py-[2px] text-[10px]">오후 {{ users.0.sum_pm }}</span>
                        </div>
                    </div>

                    <div class="px-3 py-2">
                        <table class="w-full text-[11px] leading-tight">
                            <thead class="text-slate-500">
                                <tr class="border-b border-slate-200">
                                    <th class="py-1 text-left font-medium">직위</th>
                                    <th class="py-1 text-left font-medium">성명</th>
                                    <th class="py-1 text-center font-medium">오전</th>
                                    <th class="py-1 text-center font-medium">오후</th>
                                </tr>
                            </thead>
                            <tbody class="text-slate-800">
                                {% for user in users %}
                                    {% if forloop.counter >= 2 %}
                                        <tr class="border-b border-slate-100">
                                            <td class="py-1 pr-1 whitespace-nowrap">{{ user.position }}</td>
                                            <td class="py-1 pr-1 whitespace-nowrap">{{ user.emp_name }}</td>
                                            <td class="py-1 text-center">
                                                {% if user.am == 1 %}
                                                    <span class="inline-block h-[9px] w-[9px] rounded-full bg-teal-500"></span>
                                                {% else %}
                                                    <span class="inline-block h-[9px] w-[9px] rounded-full bg-slate-200"></span>
                                                {% endif %}
                                            </td>
                                            <td class="py-1 text-center">
                                                {% if user.pm == 1 %}
                                                    <span class="inline-block h-[9px] w-[9px] rounded-full bg-teal-500"></span>
                                                {% else %}
                                                    <span class="inline-block h-[9px] w-[9px] rounded-full bg-slate-200"></span>
                                                {% endif %}
                                            </td>
                                        </tr>

                                        {% if forloop.last %}
                                            {% with max_workers|get_range:forloop.counter as range %}
                                                {% for i in range %}
                                                    <tr class="border-b border-slate-100">
                                                        <td class="py-1">&nbsp;</td>
                                                        <td class="py-1"></td>
                                                        <td class="py-1"></td>
                                                        <td class="py-1"></td>
                                                    </tr>
                                                {% endfor %}
                                            {% endwith %}
                                        {% endif %}
                                    {% endif %}
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</section>