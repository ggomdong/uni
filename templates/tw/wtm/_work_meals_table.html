{% load humanize %}
<div id="meal-table" class="rounded-2xl border border-slate-200/70 bg-white shadow-sm">
    <div class="flex flex-wrap items-center justify-between gap-3 border-b border-slate-200/70 px-5 py-4">
        <div>
            <h2 class="text-lg font-semibold text-slate-900">{{ ym }} 사용 내역</h2>
            <p class="text-xs text-slate-500">등록된 식대 내역을 확인하고 필요한 경우 삭제할 수 있습니다.</p>
        </div>
        {% if is_closed %}
            <span class="inline-flex items-center rounded-full bg-rose-100 px-2.5 py-1 text-xs font-semibold text-rose-700">마감됨</span>
        {% else %}
            <span class="inline-flex items-center rounded-full bg-emerald-100 px-2.5 py-1 text-xs font-semibold text-emerald-700">미마감</span>
        {% endif %}
    </div>
    <div class="max-h-[520px] overflow-auto">
        <table class="min-w-full text-sm">
            <thead class="sticky top-0 z-10 bg-white/90 text-slate-700 backdrop-blur">
                <tr class="border-b border-slate-200">
                    <th class="px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider">사용일</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider">직원</th>
                    <th class="px-4 py-3 text-right text-xs font-semibold uppercase tracking-wider">금액</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold uppercase tracking-wider">메모</th>
                    <th class="px-4 py-3 text-right text-xs font-semibold uppercase tracking-wider">관리</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-slate-200">
                {% for claim in claims %}
                    <tr class="transition hover:bg-slate-50">
                        <td class="px-4 py-3">{{ claim.used_date|date:"Y-m-d" }}</td>
                        <td class="px-4 py-3 font-medium text-slate-800">{{ claim.user.emp_name }}</td>
                        <td class="px-4 py-3 text-right font-semibold text-slate-900 tabular-nums">{{ claim.amount|intcomma }}</td>
                        <td class="px-4 py-3 text-slate-600">{{ claim.memo|default:"-" }}</td>
                        <td class="px-4 py-3 text-right">
                            <button
                                {% if is_closed %}disabled{% endif %}
                                hx-post="{% url 'wtm:meals_delete' claim.id %}"
                                hx-target="#meal-table"
                                hx-swap="outerHTML"
                                class="inline-flex items-center justify-center rounded-md border px-3 py-1.5 text-xs font-semibold transition focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-rose-500 focus-visible:ring-offset-2 {% if is_closed %}cursor-not-allowed border-slate-200 text-slate-300{% else %}border-rose-200 text-rose-700 hover:bg-rose-50{% endif %}"
                            >
                                삭제
                            </button>
                        </td>
                    </tr>
                {% empty %}
                    <tr>
                        <td colspan="5" class="px-4 py-10 text-center text-sm text-slate-500">등록된 내역이 없습니다.</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
